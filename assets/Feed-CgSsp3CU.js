import{j as s,M as J,t as P,i as Q,b as F}from"./ui-DKY0DGm9.js";import{r as u,L as G}from"./vendor-D6EYvIws.js";import{m as E}from"./ManualData-CVKivWWw.js";import{u as H}from"./utils-CDqJ1pPe.js";import{l as K}from"./searchAnalytics-Bz9FKtRP.js";const V=({manuals:a=[],activeTag:o="",onTagClick:i=()=>{},onLike:r=()=>{},onDownload:t=()=>{},onBookmark:n=()=>{},className:c=""})=>!a||a.length===0?s.jsxs("div",{className:`manual-grid-empty ${c}`,children:[s.jsx("div",{className:"manual-grid-empty-title",children:"No manuals found"}),s.jsx("div",{className:"manual-grid-empty-text",children:"Try adjusting your search criteria or browse different categories."})]}):s.jsx("div",{className:`manual-grid ${c}`,children:a.map(h=>s.jsx(J,{manual:h,activeTag:o,onTagClick:i,onLike:()=>r(h),onDownload:()=>t(h),onBookmark:()=>n(h)},h.id))}),W=(a,o)=>{const i=a.toLowerCase().trim();if(!i)return 0;let r=0;return(o.title||"").toLowerCase().includes(i)&&(r+=3),(o.tags||[]).map(f=>f.toLowerCase()).some(f=>f.includes(i))&&(r+=2),(o.category||"").toLowerCase().includes(i)&&(r+=1),(o.description||"").toLowerCase().includes(i)&&(r+=1),(o.sections||[]).forEach(f=>{const j=(f.title||"").toLowerCase(),p=(f.content||"").toLowerCase();(j.includes(i)||p.includes(i))&&(r+=1)}),r},z=(a,o,i)=>{const r=a.toLowerCase().trim(),t=[],n=(o.title||"").toLowerCase(),c=(o.tags||[]).map(x=>x.toLowerCase()),h=(o.category||"").toLowerCase(),v=(o.description||"").toLowerCase();n.includes(r)&&t.push("à¸«à¸±à¸§à¸‚à¹‰à¸­"),c.some(x=>x.includes(r))&&t.push("à¹à¸—à¹‡à¸"),h.includes(r)&&t.push("à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ"),v.includes(r)&&t.push("à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢"),(o.sections||[]).some(x=>{const k=(x.title||"").toLowerCase(),m=(x.content||"").toLowerCase();return k.includes(r)||m.includes(r)})&&t.push("à¹€à¸™à¸·à¹‰à¸­à¸«à¸²");const p=t.length>0?t.join(", "):"à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡";return`à¹à¸™à¸°à¸™à¸³ "${o.title}" à¹€à¸žà¸£à¸²à¸°à¸žà¸šà¸„à¸³à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡à¸à¸±à¸š "${a}" à¹ƒà¸™${p} (à¸„à¸°à¹à¸™à¸™à¸„à¸§à¸²à¸¡à¹ƒà¸à¸¥à¹‰à¹€à¸„à¸µà¸¢à¸‡: ${i})`},X=(a,o)=>{if(!a||!a.trim())return{results:[],explanations:[]};if(!Array.isArray(o)||o.length===0)return{results:[],explanations:[]};const i=o.map(n=>({manual:n,score:W(a,n)})).filter(n=>n.score>0).sort((n,c)=>c.score-n.score).slice(0,3),r=i.map(n=>n.manual),t=i.map(n=>z(a,n.manual,n.score));return{results:r,explanations:t}},se=()=>{const[a,o]=u.useState("all"),[i,r]=u.useState(""),[t,n]=u.useState(""),[c,h]=u.useState(""),[v,f]=u.useState(0),[j,p]=u.useState([]),[x,k]=u.useState([]),{t:m}=H(),L=u.useMemo(()=>!!(t||c||a!=="all"),[t,c,a]),C=u.useMemo(()=>{const e=t.toLowerCase().trim(),d=JSON.parse(localStorage.getItem("customManuals")||"[]").filter(g=>g.status==="published"),w=new Set(d.map(g=>g.id)),N=E.filter(g=>!w.has(g.id));return[...d,...N].filter(g=>{const y=g.category||"",M=g.tags||[],O=g.title||"";return!(a!=="all"&&y!==a||c&&!M.map($=>$.toLowerCase()).includes(c.toLowerCase())||e&&!`${O} ${y} ${M.join(" ")}`.toLowerCase().includes(e))})},[t,c,a,v]),I=u.useMemo(()=>{if(!L)return m("feed.resultsText");const e=[];return t&&e.push(`search: "${t}"`),a!=="all"&&e.push(`category: ${a}`),c&&e.push(`tag: ${c}`),`${m("feed.searchResults")} ${C.length} manual(s) â€¢ ${e.join(" â€¢ ")}`},[L,t,a,c,C,m]);u.useEffect(()=>{const e=()=>{f(l=>l+1)};return window.addEventListener("storage",e),window.addEventListener("manualUpdated",e),window.addEventListener("manualInteractionsUpdated",e),window.addEventListener("bookmarksUpdated",e),()=>{window.removeEventListener("storage",e),window.removeEventListener("manualUpdated",e),window.removeEventListener("manualInteractionsUpdated",e),window.removeEventListener("bookmarksUpdated",e)}},[]);const S=()=>{const e=document.getElementById("manual-list");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},T=e=>{e.preventDefault(),n(i),h("");const w=[...JSON.parse(localStorage.getItem("customManuals")||"[]").filter(N=>N.status==="published"),...E];if(i.trim()){const{results:N,explanations:b}=X(i,w);p(N),k(b)}else p([]),k([]);S()},D=e=>{o(e),h(""),n(""),p([]),k([]),S()},B=e=>{h(e),n(""),r(""),o("all"),p([]),k([]),S()},R=e=>{const l=localStorage.getItem("userData");if(!l){console.log("Please log in to like manuals");return}try{const d=JSON.parse(l),w=F(e.id,d.id);console.log(`${w.isLiked?"Liked":"Unliked"} manual: ${e.title}`)}catch(d){console.error("Error liking manual:",d)}},U=e=>{const l=Q(e.id);console.log(`Downloaded manual: ${e.title} (Total: ${l})`)},A=e=>{const l=localStorage.getItem("userData");if(!l){console.log("Please log in to bookmark manuals");return}try{const d=JSON.parse(l),w=P(e.id,d.id);console.log(`${w?"Bookmarked":"Removed bookmark from"} manual: ${e.title}`)}catch(d){console.error("Error bookmarking manual:",d)}};return u.useEffect(()=>{},[]),u.useEffect(()=>{if(t&&t.trim()){const e=localStorage.getItem("userData");let l=null;try{e&&(l=JSON.parse(e))}catch(d){console.error("Error parsing user data:",d)}K(t,C.length,l)}},[t,C.length]),u.useEffect(()=>{},[]),s.jsxs("main",{className:"feed-page",children:[s.jsxs("section",{className:"feed-hero",id:"hero-top",children:[s.jsx("h1",{className:"feed-hero-title",children:"Quick Search"}),s.jsx("p",{className:"feed-hero-sub",children:"à¸„à¹‰à¸™à¸«à¸²à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸‚à¸­à¸‡à¸­à¸‡à¸„à¹Œà¸à¸£à¸ˆà¸²à¸à¸—à¸µà¹ˆà¹€à¸”à¸µà¸¢à¸§ â€” à¸¥à¸­à¸‡à¸žà¸´à¸¡à¸žà¹Œ â€œVS Codeâ€, â€œOnboardingâ€, â€œBrand guidelineâ€ à¸«à¸£à¸·à¸­à¹€à¸¥à¸·à¸­à¸à¸«à¸¡à¸§à¸”à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡"}),s.jsx("form",{className:"feed-hero-searchWrapper",onSubmit:T,children:s.jsxs("div",{className:"feed-hero-search",children:[s.jsx("span",{className:"feed-hero-searchIcon",children:"ðŸ”"})," ",s.jsx("input",{type:"text",placeholder:m("feed.searchPlaceholder"),value:i,onChange:e=>r(e.target.value)})]})}),s.jsxs("div",{className:"feed-chipRow",children:[" ",[{id:"all",label:m("feed.categories.all")},{id:"IT",label:m("feed.categories.it")},{id:"Design",label:m("feed.categories.design")},{id:"Marketing",label:m("feed.categories.marketing")},{id:"HR",label:m("feed.categories.hr")}].map(e=>s.jsx("button",{type:"button",className:`feed-chip ${a===e.id?"is-active":""}`,onClick:()=>D(e.id),children:e.label},e.id))]})]}),t&&s.jsxs("section",{className:"feed-ai-suggestions",children:[s.jsx("div",{className:"feed-ai-header",children:s.jsxs("h2",{className:"feed-ai-title",children:['ðŸ¤– AI à¹à¸™à¸°à¸™à¸³à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸ªà¸³à¸«à¸£à¸±à¸š: "',t,'"']})}),j.length===0?s.jsx("div",{className:"feed-ai-empty",children:s.jsx("p",{children:"à¹„à¸¡à¹ˆà¸žà¸šà¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¸„à¸³à¸„à¹‰à¸™à¸«à¸²à¸‚à¸­à¸‡à¸„à¸¸à¸“ à¸¥à¸­à¸‡à¸„à¹‰à¸™à¸«à¸²à¸”à¹‰à¸§à¸¢à¸„à¸³à¸­à¸·à¹ˆà¸™à¸«à¸£à¸·à¸­à¹€à¸¥à¸·à¸­à¸à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ"})}):s.jsx("div",{className:"feed-ai-results",children:j.map((e,l)=>s.jsxs(G,{to:`/manual/${e.id}`,className:"feed-ai-card",children:[s.jsx("div",{className:"feed-ai-card-number",children:l+1}),s.jsxs("div",{className:"feed-ai-card-content",children:[s.jsx("h3",{className:"feed-ai-card-title",children:e.title}),s.jsx("p",{className:"feed-ai-card-meta",children:e.meta}),s.jsx("p",{className:"feed-ai-card-explanation",children:x[l]}),e.tags&&e.tags.length>0&&s.jsx("div",{className:"feed-ai-card-tags",children:e.tags.slice(0,3).map(d=>s.jsx("span",{className:"feed-ai-tag",children:d},d))})]}),s.jsx("div",{className:"feed-ai-card-arrow",children:"â†’"})]},e.id))})]}),s.jsxs("section",{className:"feed-main",id:"manual-list",children:[" ",s.jsxs("header",{className:"feed-mainHeader",children:[s.jsx("div",{className:"feed-mainTitle",children:m(L?"feed.searchResults":"feed.recommended")}),s.jsx("div",{className:"feed-mainSub",children:I})]})," ",s.jsx(V,{manuals:C,activeTag:c,onTagClick:B,onLike:R,onDownload:U,onBookmark:A,className:"feed-cardGrid"})]})]})};export{se as default};
