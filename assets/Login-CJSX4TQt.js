import{j as e,C as B,R as A,d as N,e as U,A as D,T as _,f as O,F as a,B as f}from"./ui-HD-sGl07.js";import{u as J,r as g,L as k}from"./vendor-D6EYvIws.js";import{u as K}from"./utils-DIoNpZQj.js";import{a as M}from"./UserData-WMet23Oe.js";import{u as z}from"./index-CZoC9ciW.js";const Y=()=>{const{t:s}=K(),h=J(),{login:q,logout:T}=z(),[j,G]=g.useState("login"),[x,t]=g.useState(!1),[b,l]=g.useState(""),[w,p]=g.useState(""),[o,v]=g.useState({emailOrUsername:"",password:""}),[c,C]=g.useState({username:"",email:"",password:"",confirmPassword:"",firstName:"",lastName:""}),i=(r,n)=>{const{name:m,value:d}=r.target;n==="login"?v(u=>({...u,[m]:d})):C(u=>({...u,[m]:d}))},I=async r=>{r.preventDefault(),t(!0),l(""),p("");try{if(!o.emailOrUsername||!o.password){l(s("login.fillAllFields")),t(!1);return}await new Promise(m=>setTimeout(m,1e3)),console.log("Attempting login with:",o.emailOrUsername);const n=M(o.emailOrUsername,o.password);console.log("Auth result:",n),n.success?(q(n.user,n.token),window.dispatchEvent(new Event("authStateChanged")),p(s("login.welcomeBack")),v({emailOrUsername:"",password:""}),setTimeout(()=>{n.user.role==="admin"?h("/admin-dashboard"):n.user.role==="creator"?h("/creator-dashboard"):h("/")},800)):(console.error("Login failed:",n.message),l(s("login.invalidCredentials")))}catch(n){console.error("Login error:",n),l(s("login.loginFailed"))}finally{t(!1)}},F=async r=>{r.preventDefault(),t(!0),l(""),p("");try{const{username:n,email:m,password:d,confirmPassword:u,firstName:y,lastName:S}=c;if(!n||!m||!d||!u||!y||!S){l(s("login.fillAllFields")),t(!1);return}if(d!==u){l(s("login.passwordsDontMatch")),t(!1);return}if(d.length<6){l(s("login.passwordTooShort")),t(!1);return}await new Promise(R=>setTimeout(R,1500));const L={id:Date.now(),username:n,email:m,firstName:y,lastName:S,role:"user",avatar:null,department:"",position:"",isActive:!0,preferences:{notifications:!0,darkMode:!1,emailUpdates:!0,language:"en"},stats:{manualsViewed:0,manualsDownloaded:0,manualsBookmarked:0,loginCount:1},createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),permissions:["view_manuals"]},P=JSON.parse(localStorage.getItem("quickhelp_users")||"[]");P.push(L),localStorage.setItem("quickhelp_users",JSON.stringify(P)),localStorage.setItem("userData",JSON.stringify(L)),localStorage.setItem("authToken","mock_token_"+Date.now()),window.dispatchEvent(new Event("authStateChanged")),p(s("login.accountCreated")),C({username:"",email:"",password:"",confirmPassword:"",firstName:"",lastName:""}),setTimeout(()=>h("/"),1200)}catch(n){console.error("Registration error:",n),l(s("login.registrationFailed"))}finally{t(!1)}},E=()=>{T(),h("/")};return e.jsx("div",{className:"login-page",children:e.jsx(B,{children:e.jsx(A,{className:"justify-content-center",children:e.jsxs(N,{xs:12,sm:10,md:8,lg:6,xl:5,children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h1",{className:"login-title",children:s("login.title")}),e.jsx("p",{className:"login-subtitle",children:s("login.subtitle")})]}),e.jsxs(U,{className:"login-card",children:[e.jsxs(U.Body,{children:[b&&e.jsx(D,{variant:"danger",className:"mb-3",children:b}),w&&e.jsx(D,{variant:"success",className:"mb-3",children:w}),e.jsxs(_,{activeKey:j,onSelect:r=>r&&G(r),className:"login-tabs nav-justified",fill:!0,children:[e.jsxs(O,{eventKey:"login",title:e.jsxs("span",{className:"tab-title",children:[e.jsx("i",{className:"fas fa-sign-in-alt"}),s("login.signIn")]}),children:[" ",j==="login"&&e.jsxs(a,{onSubmit:I,className:"mt-3",children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.emailOrUsername")}),e.jsx(a.Control,{type:"text",name:"emailOrUsername",placeholder:s("login.emailOrUsernamePlaceholder"),value:o.emailOrUsername,onChange:r=>i(r,"login"),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.password")}),e.jsx(a.Control,{type:"password",name:"password",placeholder:s("login.passwordPlaceholder"),value:o.password,onChange:r=>i(r,"login"),required:!0})]}),e.jsx(f,{variant:"primary",type:"submit",className:"w-100 login-btn mb-3",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),s("login.signingIn")]}):s("login.signIn")})]})]}),e.jsx(O,{eventKey:"register",title:e.jsxs("span",{className:"tab-title",children:[e.jsx("i",{className:"fas fa-user-plus me-2"}),s("login.signUp")]}),children:j==="register"&&e.jsxs(a,{onSubmit:F,className:"mt-3",children:[e.jsxs(A,{children:[e.jsx(N,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.firstName")}),e.jsx(a.Control,{type:"text",name:"firstName",placeholder:s("login.firstNamePlaceholder"),value:c.firstName,onChange:r=>i(r,"register"),required:!0})]})}),e.jsx(N,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.lastName")}),e.jsx(a.Control,{type:"text",name:"lastName",placeholder:s("login.lastNamePlaceholder"),value:c.lastName,onChange:r=>i(r,"register"),required:!0})]})})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.username")}),e.jsx(a.Control,{type:"text",name:"username",placeholder:s("login.usernamePlaceholder"),value:c.username,onChange:r=>i(r,"register"),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.email")}),e.jsx(a.Control,{type:"email",name:"email",placeholder:s("login.emailPlaceholder"),value:c.email,onChange:r=>i(r,"register"),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.password")}),e.jsx(a.Control,{type:"password",name:"password",placeholder:s("login.passwordPlaceholder"),value:c.password,onChange:r=>i(r,"register"),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:s("login.confirmPassword")}),e.jsx(a.Control,{type:"password",name:"confirmPassword",placeholder:s("login.confirmPasswordPlaceholder"),value:c.confirmPassword,onChange:r=>i(r,"register"),required:!0})]}),e.jsx(f,{variant:"success",type:"submit",className:"w-100 register-btn mb-3",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),s("login.creatingAccount")]}):s("login.createAccount")})]})})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(f,{variant:"outline-secondary",size:"sm",onClick:E,className:"guest-btn",children:s("login.continueAsGuest")})})]})," "]}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs("div",{className:"demo-credentials-box",children:[e.jsx("small",{className:"text-muted d-block mb-2",children:e.jsx("strong",{children:"üìù Demo Login Credentials:"})}),e.jsxs("div",{className:"demo-creds-grid",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"Admin:"})," admin / admin@company.com"]}),e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"Creator:"})," mariagarcia / maria.garcia@company.com"]}),e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"User:"})," johndoe / john.doe@company.com"]})]}),e.jsx("small",{className:"text-muted d-block mt-2",children:e.jsx("em",{children:"Password: any text (demo mode)"})})]})}),e.jsx("div",{className:"text-center mt-3",children:e.jsxs("small",{className:"text-muted",children:[e.jsx(k,{to:"/about",className:"text-decoration-none",children:s("nav.about")})," ‚Ä¢ ",e.jsx(k,{to:"/faq",className:"text-decoration-none",children:s("nav.faq")})]})})]})})})})};export{Y as default};
