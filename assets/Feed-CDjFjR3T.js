import{j as s,M as B,t as U,i as A,b as J}from"./ui-Cx5CCx16.js";import{r as h,L as O}from"./vendor-D6EYvIws.js";import{g as $}from"./manualRepository-BSTK98NG.js";import{u as P}from"./utils-BWPLNOGI.js";import{l as F}from"./searchAnalytics-Bz9FKtRP.js";import"./ManualData-CCWVZZls.js";const G=({manuals:a=[],activeTag:o="",onTagClick:i=()=>{},onLike:r=()=>{},onDownload:t=()=>{},onBookmark:n=()=>{},className:d=""})=>!a||a.length===0?s.jsxs("div",{className:`manual-grid-empty ${d}`,children:[s.jsx("div",{className:"manual-grid-empty-title",children:"No manuals found"}),s.jsx("div",{className:"manual-grid-empty-text",children:"Try adjusting your search criteria or browse different categories."})]}):s.jsx("div",{className:`manual-grid ${d}`,children:a.map(m=>s.jsx(B,{manual:m,activeTag:o,onTagClick:i,onLike:()=>r(m),onDownload:()=>t(m),onBookmark:()=>n(m)},m.id))}),H=(a,o)=>{const i=a.toLowerCase().trim();if(!i)return 0;let r=0;return(o.title||"").toLowerCase().includes(i)&&(r+=3),(o.tags||[]).map(f=>f.toLowerCase()).some(f=>f.includes(i))&&(r+=2),(o.category||"").toLowerCase().includes(i)&&(r+=1),(o.description||"").toLowerCase().includes(i)&&(r+=1),(o.sections||[]).forEach(f=>{const j=(f.title||"").toLowerCase(),g=(f.content||"").toLowerCase();(j.includes(i)||g.includes(i))&&(r+=1)}),r},K=(a,o,i)=>{const r=a.toLowerCase().trim(),t=[],n=(o.title||"").toLowerCase(),d=(o.tags||[]).map(p=>p.toLowerCase()),m=(o.category||"").toLowerCase(),L=(o.description||"").toLowerCase();n.includes(r)&&t.push("à¸«à¸±à¸§à¸‚à¹‰à¸­"),d.some(p=>p.includes(r))&&t.push("à¹à¸—à¹‡à¸"),m.includes(r)&&t.push("à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ"),L.includes(r)&&t.push("à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢"),(o.sections||[]).some(p=>{const w=(p.title||"").toLowerCase(),u=(p.content||"").toLowerCase();return w.includes(r)||u.includes(r)})&&t.push("à¹€à¸™à¸·à¹‰à¸­à¸«à¸²");const g=t.length>0?t.join(", "):"à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡";return`à¹à¸™à¸°à¸™à¸³ "${o.title}" à¹€à¸žà¸£à¸²à¸°à¸žà¸šà¸„à¸³à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡à¸à¸±à¸š "${a}" à¹ƒà¸™${g} (à¸„à¸°à¹à¸™à¸™à¸„à¸§à¸²à¸¡à¹ƒà¸à¸¥à¹‰à¹€à¸„à¸µà¸¢à¸‡: ${i})`},Q=(a,o)=>{if(!a||!a.trim())return{results:[],explanations:[]};if(!Array.isArray(o)||o.length===0)return{results:[],explanations:[]};const i=o.map(n=>({manual:n,score:H(a,n)})).filter(n=>n.score>0).sort((n,d)=>d.score-n.score).slice(0,3),r=i.map(n=>n.manual),t=i.map(n=>K(a,n.manual,n.score));return{results:r,explanations:t}},_=()=>{const[a,o]=h.useState("all"),[i,r]=h.useState(""),[t,n]=h.useState(""),[d,m]=h.useState(""),[L,f]=h.useState(0),[j,g]=h.useState([]),[p,w]=h.useState([]),{t:u}=P(),v=h.useMemo(()=>!!(t||d||a!=="all"),[t,d,a]),k=h.useMemo(()=>{const e=t.toLowerCase().trim();return $().filter(l=>{const x=l.category||"",C=l.tags||[],R=l.title||"";return!(a!=="all"&&x!==a||d&&!C.map(y=>y.toLowerCase()).includes(d.toLowerCase())||e&&!`${R} ${x} ${C.join(" ")}`.toLowerCase().includes(e))})},[t,d,a,L]),S=h.useMemo(()=>{if(!v)return u("feed.resultsText");const e=[];return t&&e.push(`search: "${t}"`),a!=="all"&&e.push(`category: ${a}`),d&&e.push(`tag: ${d}`),`${u("feed.searchResults")} ${k.length} manual(s) â€¢ ${e.join(" â€¢ ")}`},[v,t,a,d,k,u]);h.useEffect(()=>{const e=()=>{f(c=>c+1)};return window.addEventListener("storage",e),window.addEventListener("manualUpdated",e),window.addEventListener("manualInteractionsUpdated",e),window.addEventListener("bookmarksUpdated",e),()=>{window.removeEventListener("storage",e),window.removeEventListener("manualUpdated",e),window.removeEventListener("manualInteractionsUpdated",e),window.removeEventListener("bookmarksUpdated",e)}},[]);const N=()=>{const e=document.getElementById("manual-list");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},E=e=>{e.preventDefault(),n(i),m("");const c=$();if(i.trim()){const{results:l,explanations:x}=Q(i,c);g(l),w(x)}else g([]),w([]);N()},b=e=>{o(e),m(""),n(""),g([]),w([]),N()},M=e=>{m(e),n(""),r(""),o("all"),g([]),w([]),N()},T=e=>{const c=localStorage.getItem("userData");if(!c){console.log("Please log in to like manuals");return}try{const l=JSON.parse(c),x=J(e.id,l.id);console.log(`${x.isLiked?"Liked":"Unliked"} manual: ${e.title}`)}catch(l){console.error("Error liking manual:",l)}},D=e=>{const c=A(e.id);console.log(`Downloaded manual: ${e.title} (Total: ${c})`)},I=e=>{const c=localStorage.getItem("userData");if(!c){console.log("Please log in to bookmark manuals");return}try{const l=JSON.parse(c),x=U(l.id,e);console.log(`${x?"Bookmarked":"Removed bookmark from"} manual: ${e.title}`)}catch(l){console.error("Error bookmarking manual:",l)}};return h.useEffect(()=>{if(t&&t.trim()){const e=localStorage.getItem("userData");let c=null;try{e&&(c=JSON.parse(e))}catch(l){console.error("Error parsing user data:",l)}F(t,k.length,c)}},[t,k.length]),s.jsxs("main",{className:"feed-page",children:[s.jsxs("section",{className:"feed-hero",id:"hero-top",children:[s.jsx("h1",{className:"feed-hero-title",children:u("feed.title")}),s.jsx("p",{className:"feed-hero-sub",children:u("feed.subtitle")}),s.jsx("form",{className:"feed-hero-searchWrapper",onSubmit:E,children:s.jsxs("div",{className:"feed-hero-search",children:[s.jsx("span",{className:"feed-hero-searchIcon",children:"ðŸ”"}),s.jsx("input",{type:"text",placeholder:u("feed.searchPlaceholder"),value:i,onChange:e=>r(e.target.value)})]})}),s.jsx("div",{className:"feed-chipRow",children:["all","IT","Design","Marketing","HR"].map(e=>s.jsx("button",{type:"button",className:`feed-chip ${a===e?"is-active":""}`,onClick:()=>b(e),children:u(`feed.categories.${e.toLowerCase()}`)},e))})]}),t&&s.jsxs("section",{className:"feed-ai-suggestions",children:[s.jsx("div",{className:"feed-ai-header",children:s.jsxs("h2",{className:"feed-ai-title",children:[u("feed.aiSuggestions"),' "',t,'"']})}),j.length===0?s.jsx("div",{className:"feed-ai-empty",children:s.jsx("p",{children:u("feed.noAiResults")})}):s.jsx("div",{className:"feed-ai-results",children:j.map((e,c)=>s.jsxs(O,{to:`/manual/${e.id}`,className:"feed-ai-card",children:[s.jsx("div",{className:"feed-ai-card-number",children:c+1}),s.jsxs("div",{className:"feed-ai-card-content",children:[s.jsx("h3",{className:"feed-ai-card-title",children:e.title}),s.jsx("p",{className:"feed-ai-card-meta",children:e.meta}),s.jsx("p",{className:"feed-ai-card-explanation",children:p[c]}),e.tags&&e.tags.length>0&&s.jsx("div",{className:"feed-ai-card-tags",children:e.tags.slice(0,3).map(l=>s.jsx("span",{className:"feed-ai-tag",children:l},l))})]}),s.jsx("div",{className:"feed-ai-card-arrow",children:"â†’"})]},e.id))})]}),s.jsxs("section",{className:"feed-main",id:"manual-list",children:[s.jsxs("header",{className:"feed-mainHeader",children:[s.jsx("div",{className:"feed-mainTitle",children:u(v?"feed.searchResults":"feed.recommended")}),s.jsx("div",{className:"feed-mainSub",children:S})]}),s.jsx(G,{manuals:k,activeTag:d,onTagClick:M,onLike:T,onDownload:D,onBookmark:I,className:"feed-cardGrid"})]})]})};export{_ as default};
