import{j as e,m as f}from"./ui-DKY0DGm9.js";import{r as q}from"./vendor-D6EYvIws.js";import{u as g}from"./utils-CDqJ1pPe.js";import{g as y,a as S}from"./CreatorRequests-CrYA46hB.js";import{u as w,A as T}from"./AlertModal-CrmLqu_t.js";import{b as D}from"./UserData-CNiV9beM.js";const U=()=>{const{t:s}=g(),[l,N]=q.useState(null),[r,p]=q.useState(null),[i,x]=q.useState({team:"",reason:"",types:""}),{modalState:c,showAlert:u,hideAlert:v}=w();q.useEffect(()=>{const d=localStorage.getItem("userData");if(d)try{const a=JSON.parse(d);N(a);const m=y(a.id);p(m)}catch(a){console.error("Error loading user data:",a)}},[]);const n=r&&r.status==="pending",t=r?r.status:null,R=r?r.note:null,h=d=>{const{name:a,value:m}=d.target;x(j=>({...j,[a]:m}))},b=d=>{if(d.preventDefault(),!l){u("Please login to submit a creator request","warning","Login Required");return}if(n){u(s("creatorRequest.alreadySubmitted")||"You already have a pending request","info","Request Already Submitted");return}try{const a=S({userId:l.id,username:l.username,team:i.team,reason:i.reason,types:i.types.split(",").map(o=>o.trim()).filter(Boolean)});p(a),D().filter(o=>o.role==="admin").forEach(o=>{f({userId:o.id,message:`New creator request from ${l.username} (${l.firstName} ${l.lastName})`,type:"info",link:"/admin-dashboard"})}),u(s("creatorRequest.submitted")||"Request submitted successfully!","success","Request Submitted"),x({team:"",reason:"",types:""})}catch(a){console.error("Error submitting request:",a),u("Failed to submit request. Please try again.","error","Submission Failed")}};return e.jsxs("main",{className:"creq-page",children:[e.jsxs("div",{className:"creq-inner",children:[" ",e.jsxs("header",{className:"creq-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"creq-title",children:s("creatorRequest.title")}),e.jsx("p",{className:"creq-sub",children:s("creatorRequest.subtitle")})]}),e.jsxs("span",{className:`creq-statusChip creq-${t}`,children:[t==="pending"&&s("creatorRequest.statuses.pending"),t==="approved"&&s("creatorRequest.statuses.approved"),t==="rejected"&&s("creatorRequest.statuses.rejected")]})]}),e.jsxs("div",{className:"creq-grid",children:[" ",e.jsxs("section",{className:"creq-card",children:[e.jsx("h2",{className:"creq-cardTitle",children:s("creatorRequest.reasonContext")}),e.jsx("p",{className:"creq-cardSub",children:s("creatorRequest.reasonDesc")}),e.jsxs("form",{className:"creq-form",onSubmit:b,children:[" ",e.jsxs("div",{className:"creq-field",children:[e.jsx("label",{children:s("creatorRequest.team")}),e.jsx("input",{type:"text",name:"team",placeholder:s("creatorRequest.teamPlaceholder"),value:i.team,onChange:h,disabled:n})]}),e.jsxs("div",{className:"creq-field",children:[e.jsx("label",{children:s("creatorRequest.reason")}),e.jsx("textarea",{rows:4,name:"reason",placeholder:s("creatorRequest.reasonPlaceholder"),value:i.reason,onChange:h,disabled:n})]}),e.jsxs("div",{className:"creq-field",children:[e.jsx("label",{children:s("creatorRequest.manualTypes")}),e.jsx("input",{type:"text",name:"types",placeholder:s("creatorRequest.typesPlaceholder"),value:i.types,onChange:h,disabled:n})]}),e.jsxs("label",{className:"creq-checkRow",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{children:s("creatorRequest.agreement")})]}),e.jsx("button",{type:"submit",className:"creq-btn primary",disabled:n,children:s(n?"creatorRequest.pending":"creatorRequest.submit")})]})]})," ",e.jsxs("section",{className:"creq-card",children:[e.jsx("h2",{className:"creq-cardTitle",children:s("creatorRequest.requestStatus")}),e.jsx("p",{className:"creq-cardSub",children:s("creatorRequest.statusDesc")})," ",e.jsxs("div",{className:"creq-statusBox",children:[e.jsxs("div",{className:"creq-statusRow",children:[e.jsx("span",{className:"creq-statusLabel",children:s("creatorRequest.currentStatus")}),t?e.jsxs("span",{className:`creq-statusPill creq-${t}`,children:[t==="pending"&&s("creatorRequest.statuses.pending"),t==="approved"&&s("creatorRequest.statuses.approved"),t==="rejected"&&s("creatorRequest.statuses.rejected")]}):e.jsx("span",{className:"creq-statusPill creq-none",children:"No request submitted"})]}),e.jsx("p",{className:"creq-statusNote",children:R||s("creatorRequest.timeline.reviewNote")})]})," ",e.jsxs("div",{className:"creq-timeline",children:[e.jsxs("div",{className:`creq-tlItem ${r?"done":""}`,children:[e.jsx("div",{className:"creq-tlDot"}),e.jsxs("div",{children:[e.jsx("div",{className:"creq-tlTitle",children:s("creatorRequest.timeline.submitted")}),e.jsx("div",{className:"creq-tlSub",children:r?new Date(r.createdAt).toLocaleString():"Not yet submitted"})]})]}),e.jsxs("div",{className:`creq-tlItem ${t&&t!=="pending"?"done":t==="pending"?"active":""}`,children:[e.jsx("div",{className:"creq-tlDot"}),e.jsxs("div",{children:[e.jsx("div",{className:"creq-tlTitle",children:s("creatorRequest.timeline.underReview")}),e.jsx("div",{className:"creq-tlSub",children:s("creatorRequest.timeline.byAdmin")})]})]}),e.jsxs("div",{className:`creq-tlItem ${t==="approved"?"done":""}`,children:[e.jsx("div",{className:"creq-tlDot"}),e.jsxs("div",{children:[e.jsx("div",{className:"creq-tlTitle",children:s("creatorRequest.timeline.approved")}),e.jsx("div",{className:"creq-tlSub",children:t==="approved"&&r?.reviewedAt?new Date(r.reviewedAt).toLocaleString():s("creatorRequest.timeline.effectNote")})]})]})]}),e.jsxs("div",{className:"creq-helpBox",children:[e.jsx("div",{className:"creq-helpTitle",children:s("creatorRequest.needHelp")}),e.jsx("div",{className:"creq-helpText",children:s("creatorRequest.helpText")})]})," "]})]})]}),e.jsx(T,{show:c.show,onHide:v,title:c.title,message:c.message,variant:c.variant,onConfirm:c.onConfirm,confirmText:c.confirmText,cancelText:c.cancelText})]})};export{U as default};
